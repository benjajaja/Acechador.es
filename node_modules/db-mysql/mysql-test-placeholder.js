var mysql = require("./db-mysql");

mysql.Query.prototype.debug = function(rows, cols) {
    console.log("COLUMNS:", cols);
    console.log("ROWS: ", rows);
};

new mysql.Database({
    hostname: 'localhost',
    user: 'root',
    password: 'password',
    database: 'node'
}).connect(function(error, server) {
    if (error) {
        return console.log('ERROR while connecting: ' + error);
    }
    console.log('Connected to:');
    console.log(server);
    console.log('Connection alive: ' + this.isConnected());

    var db = this;
    this.query().select('*').from('users').where('id=?', [ 1 ]).or('name LIKE ?', [ '%orna%' ]).execute(function(err, rows, columns) {
        if (err) {
            return console.log('QUERY error: ' + error);
        }
        console.log(rows.length + ' ROWS');

        this.debug(rows, columns);

        /*
        var pause = 20;
        console.log('Pausing for ' + pause + ' seconds');
        setTimeout(function() {
            console.log('Connection alive: ' + db.isConnected());
        }, pause * 1000);
        */
    });
});
